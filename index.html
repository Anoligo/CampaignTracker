<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iron Meridian Campaign Tracker</title>
    <base href="/">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="dist/css/main.min.css">
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar Navigation -->
            <div id="sidebar-placeholder"></div>

            <!-- Main Content Area -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div id="content" class="content-area">
                    
                    <!-- Dashboard Section -->
                    <div id="dashboard" class="section">
                        <h1 class="text-accent">Welcome to Iron Meridian Campaign Tracker</h1>
                        <p class="text">Select a section from the sidebar to begin managing your campaign.</p>
                        
                        <div class="row mt-4">
                            <div class="col-md-4">
                                <div class="card shadow-accent">
                                    <div class="card-body bg-card">
                                        <h5 class="card-title text-accent"><i class="fas fa-scroll me-2"></i>Active Quests</h5>
                                        <p class="card-text text" id="activeQuestsCount">Loading...</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card shadow-accent">
                                    <div class="card-body bg-card">
                                        <h5 class="card-title text-accent"><i class="fas fa-users me-2"></i>Party Members</h5>
                                        <p class="card-text text" id="partyMembersCount">Loading...</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card shadow-accent">
                                    <div class="card-body bg-card">
                                        <h5 class="card-title text-accent"><i class="fas fa-map-marked-alt me-2"></i>Locations Discovered</h5>
                                        <p class="card-text text" id="locationsCount">Loading...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quests Section -->
                    <div id="quests" class="section">
                        <div class="row">
                            <!-- Quest List -->
                            <div class="col-md-4">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h2 class="text-accent">Quests</h2>
                                    <button id="addQuestBtn" class="btn btn-primary">
                                        <i class="fas fa-plus"></i> Add Quest
                                    </button>
                                </div>
                                <div class="input-group mb-3">
                                    <span class="input-group-text"><i class="fas fa-search"></i></span>
                                    <input type="text" id="questSearch" class="form-control" placeholder="Search quests...">
                                </div>
                                <div id="questList" class="list-group">
                                    <!-- Quests will be loaded here -->
                                </div>
                            </div>
                            <!-- Quest Details -->
                            <div class="col-md-8">
                                <div id="questDetails" class="card h-100">
                                    <div id="questDetailsContent">
                                        <div class="empty-state">
                                            <i class="fas fa-scroll fa-3x mb-3"></i>
                                            <p class="empty-state-message">Select a quest to view details</p>
                                        </div>
                                    </div>
                                    <div class="quest-actions">
                                        <button id="editQuestBtn" class="btn btn-secondary me-2" disabled>
                                            <i class="fas fa-edit"></i> Edit
                                        </button>
                                        <button id="deleteQuestBtn" class="btn btn-danger" disabled>
                                            <i class="fas fa-trash"></i> Delete
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Players Section -->
                    <div id="players" class="section">
                        <div class="row">
                            <!-- Player List -->
                            <div class="col-md-4">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h2 class="text-accent">Player Characters</h2>
                                    <button id="addPlayerBtn" class="btn btn-primary">
                                        <i class="fas fa-plus"></i> Add Player
                                    </button>
                                </div>
                                <div class="input-group mb-3">
                                    <span class="input-group-text"><i class="fas fa-search"></i></span>
                                    <input type="text" id="playerSearch" class="form-control" placeholder="Search players...">
                                </div>
                                <div id="playerList" class="list-group">
                                    <!-- Players will be loaded here -->
                                </div>
                            </div>
                            <!-- Player Details -->
                            <div class="col-md-8">
                                <div id="playerDetails" class="card h-100">
                                    <div id="playerDetailsContent">
                                        <div class="empty-state">
                                            <i class="fas fa-user fa-3x mb-3"></i>
                                            <p class="empty-state-message">Select a player to view details</p>
                                        </div>
                                    </div>
                                    <div class="player-actions">
                                        <button id="editPlayerBtn" class="btn btn-secondary me-2" disabled>
                                            <i class="fas fa-edit"></i> Edit
                                        </button>
                                        <button id="deletePlayerBtn" class="btn btn-danger" disabled>
                                            <i class="fas fa-trash"></i> Delete
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Characters (NPCs) Section -->
                    <div id="characters" class="section">
                        <div class="row">
                            <!-- Character List -->
                            <div class="col-md-4">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h2 class="text-accent">Non-Player Characters</h2>
                                    <button id="addCharacterBtn" class="btn btn-primary">
                                        <i class="fas fa-plus"></i> Add NPC
                                    </button>
                                </div>
                                <div class="input-group mb-3">
                                    <span class="input-group-text"><i class="fas fa-search"></i></span>
                                    <input type="text" id="characterSearch" class="form-control" placeholder="Search NPCs...">
                                </div>
                                <div id="characterList" class="list-group">
                                    <!-- NPCs will be loaded here -->
                                </div>
                            </div>
                            <!-- Character Details -->
                            <div class="col-md-8">
                                <div id="characterDetails" class="card h-100">
                                    <div id="characterDetailsContent">
                                        <div class="empty-state">
                                            <i class="fas fa-user-shield fa-3x mb-3"></i>
                                            <p class="empty-state-message">Select an NPC to view details</p>
                                        </div>
                                    </div>
                                    <div class="character-actions">
                                        <button id="editCharacterBtn" class="btn btn-secondary me-2" disabled>
                                            <i class="fas fa-edit"></i> Edit
                                        </button>
                                        <button id="deleteCharacterBtn" class="btn btn-danger" disabled>
                                            <i class="fas fa-trash"></i> Delete
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Loot Section -->
                    <div id="loot" class="section">
                        <div class="loot-container">
                            <!-- Loot Filters -->
                            <div class="loot-filters">
                                <div class="loot-filters__search">
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="fas fa-search"></i></span>
                                        <input type="text" id="lootItemSearch" class="form-control" placeholder="Search items..." data-search-type="loot">
                                    </div>
                                </div>
                                <div class="loot-filters__controls">
                                    <button id="addItemBtn" class="btn btn-primary">
                                        <i class="fas fa-plus me-2"></i>Add Item
                                    </button>
                                </div>
                            </div>

                            <div class="loot-content">
                                <!-- Item List -->
                                <div class="loot-list-container">
                                    <h2 class="section-title">Loot & Curses</h2>
                                    <div id="itemList" class="loot-list">
                                        <!-- Items will be loaded here -->
                                        <div class="loot-empty">
                                            <div class="loot-empty__icon">
                                                <i class="fas fa-coins"></i>
                                            </div>
                                            <p class="loot-empty__message">No items found</p>
                                            <button id="addFirstItemBtn" class="btn btn-primary">
                                                <i class="fas fa-plus me-2"></i>Add Your First Item
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Item Details -->
                                <div class="loot-details-container">
                                    <div id="itemDetails" class="loot-details">
                                        <div class="loot-empty">
                                            <i class="fas fa-coins fa-3x mb-3"></i>
                                            <p class="loot-empty__message">Select an item to view details</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        </div>
                    </div>

                    <!-- Locations Section -->
                    <div id="locations" class="section">
                        <div class="row mb-3">
                            <div class="col-12">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h2 class="text-accent">World Map</h2>
                                    <div>
                                        <button id="addLocationBtn" class="btn btn-primary">
                                            <i class="fas fa-plus"></i> Add Location
                                        </button>
                                    </div>
                                </div>
                                <div id="worldMapContainer">
                                    <div id="mapLoadingOverlay">
                                        <div class="text-center">
                                            <div class="spinner-border" role="status">
                                                <span class="visually-hidden">Loading...</span>
                                            </div>
                                            <p class="mt-2">Loading map...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <!-- Location List -->
                            <div class="col-md-4">
                                <div class="input-group mb-3">
                                    <span class="input-group-text"><i class="fas fa-search"></i></span>
                                    <input type="text" id="locationSearch" class="form-control" placeholder="Search locations...">
                                </div>
                                <div id="locationList" class="list-group">
                                    <!-- Locations will be loaded here -->
                                </div>
                            </div>
                            <!-- Location Details -->
                            <div class="col-md-8">
                                <div id="locationDetails" class="card h-100">
                                    <div class="empty-state">
                                        <i class="fas fa-map-marker-alt fa-3x mb-3"></i>
                                        <p class="empty-state-message">Select a location to view details</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Notes Section -->
                    <div id="notes" class="section">
                        <div class="row">
                            <!-- Notes List -->
                            <div class="col-md-4">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h2 class="text-accent">Backstories & Notes</h2>
                                    <button id="addNoteBtn" class="btn btn-primary">
                                        <i class="fas fa-plus"></i> Add Note
                                    </button>
                                </div>
                                <div class="input-group mb-3">
                                    <span class="input-group-text"><i class="fas fa-search"></i></span>
                                    <input type="text" id="noteSearch" class="form-control" placeholder="Search notes...">
                                </div>
                                <div id="noteList" class="list-group">
                                    <!-- Notes will be loaded here -->
                                </div>
                            </div>
                            <!-- Note Details -->
                            <div class="col-md-8">
                                <div id="noteDetails" class="card h-100">
                                    <div class="empty-state">
                                        <i class="fas fa-book fa-3x mb-3"></i>
                                        <p class="empty-state-message">Select a note to view details</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Guild Section -->
                    <div id="guild" class="section">
                        <h2 class="text-accent">Guild Logs</h2>
                        
                        <!-- Activity Log Section -->
                        <div class="card mb-4">
                            <div class="card-header bg-card-header">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h3 class="h5 mb-0">Guild Activities</h3>
                                    <button class="btn btn-primary btn-sm new-activity-btn">
                                        <i class="fas fa-plus me-1"></i> New Activity
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <div class="input-group">
                                        <input type="text" class="form-control activity-search-input" placeholder="Search activities...">
                                        <button class="btn btn-outline-secondary activity-search-btn" type="button">
                                            <i class="fas fa-search"></i>
                                        </button>
                                    </div>
                                    <div class="btn-group mt-2" role="group">
                                        <button type="button" class="btn btn-sm btn-outline-secondary activity-filter" data-type="all">All</button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary activity-filter" data-type="quest">Quests</button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary activity-filter" data-type="event">Events</button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary activity-filter" data-type="meeting">Meetings</button>
                                    </div>
                                </div>
                                <div class="activity-list">
                                    <!-- Activities will be loaded here -->
                                    <div class="text-center py-4">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Loading...</span>
                                        </div>
                                        <p class="mt-2 text-muted">Loading activities...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Resources Section -->
                        <div class="card">
                            <div class="card-header bg-card-header">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h3 class="h5 mb-0">Guild Resources</h3>
                                    <button class="btn btn-primary btn-sm new-resource-btn">
                                        <i class="fas fa-plus me-1"></i> New Resource
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <div class="input-group">
                                        <input type="text" class="form-control resource-search-input" placeholder="Search resources...">
                                        <button class="btn btn-outline-secondary resource-search-btn" type="button">
                                            <i class="fas fa-search"></i>
                                        </button>
                                    </div>
                                    <div class="btn-group mt-2" role="group">
                                        <button type="button" class="btn btn-sm btn-outline-secondary resource-filter" data-type="all">All</button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary resource-filter" data-type="gold">Gold</button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary resource-filter" data-type="item">Items</button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary resource-filter" data-type="information">Information</button>
                                    </div>
                                </div>
                                <div class="resource-list">
                                    <!-- Resources will be loaded here -->
                                    <div class="text-center py-4">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Loading...</span>
                                        </div>
                                        <p class="mt-2 text-muted">Loading resources...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Activity Form Modal -->
                        <div class="modal fade" id="activityFormModal" tabindex="-1" aria-hidden="true">
                            <div class="modal-dialog modal-lg">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">New Activity</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <!-- Activity form will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Resource Form Modal -->
                        <div class="modal fade" id="resourceFormModal" tabindex="-1" aria-hidden="true">
                            <div class="modal-dialog modal-lg">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">New Resource</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <!-- Resource form will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Factions Section -->
                    <div id="factions" class="section">
                        <div class="row">
                            <div class="col-12">
                                <div id="factions-container">
                                    <!-- Factions content will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Characters Section -->
                    <div id="characters" class="section">
                        <div class="row">
                            <!-- Character List -->
                            <div class="col-md-4">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h2 class="text-accent">Characters</h2>
                                    <button id="addCharacterBtn" class="btn btn-primary">
                                        <i class="fas fa-plus"></i> Add Character
                                    </button>
                                </div>
                                <div class="input-group mb-3">
                                    <span class="input-group-text"><i class="fas fa-search"></i></span>
                                    <input type="text" id="characterSearch" class="form-control" placeholder="Search characters...">
                                </div>
                                <div id="characterList" class="list-group">
                                    <!-- Characters will be loaded here -->
                                </div>
                            </div>
                            
                            <!-- Character Details -->
                            <div class="col-md-8">
                                <div id="characterDetails" class="card h-100">
                                    <div class="empty-state">
                                        <i class="fas fa-user-shield fa-3x mb-3"></i>
                                        <p class="empty-state-message">Select a character to view details</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Tom Select for enhanced dropdowns -->
    <script src="https://cdn.jsdelivr.net/npm/tom-select@2.0.0/dist/js/tom-select.complete.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tom-select@2.0.0/dist/css/tom-select.css" rel="stylesheet">
    
    <!-- UUID library -->
    <script>
        // Load uuid library and make it available globally
        (function() {
            window.uuid = {
                v4: function() {
                    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                        var r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);
                        return v.toString(16);
                    });
                }
            };
        })();
    </script>
    
    <!-- Make bootstrap available globally -->
    <script type="module">
        // Make bootstrap available globally for dynamic modal initialization
        window.bootstrap = bootstrap;
    </script>
    
    <!-- Sidebar Loader -->
    <script src="/scripts/sidebar-loader.js" type="module"></script>

    <!-- Custom JavaScript -->
    <script src="/scripts/main.js" type="module"></script>
</body>
</html>